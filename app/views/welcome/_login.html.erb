

<div class="modal fade" id="login" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Login</h4>
      </div>
      <div class="modal-body">
        
    <%= form_for(resource, :as => resource_name, :url => session_path(resource_name), :remote => true, :html => {:'data-type' => 'json'} ) do |f| %>
      <%= devise_error_messages! %>
      <div id = "error">
        
      </div>
      <div>
        <%= f.label :email %><br />
        <%= f.email_field :email, :autofocus => true %>
      </div>
      
      <div>
        <%= f.label :password %><br />
        <%= f.password_field :password %>
      </div>
      
      <% if devise_mapping.rememberable? -%>
        <div><%= f.check_box :remember_me %> <%= f.label :remember_me %></div>
      <% end -%>
      <%= f.submit "Sign in", :class => 'btn btn-small btn-success' %>
    <% end %>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>


<script>
$("form#new_user").bind("ajax:success", function(e, data, status, xhr) {
  if (data.success) {
    $('#login').modal('hide');
     window.location.replace('/');
  } 
  else {
    console.log(xhr.responseJSON);
    return alert(xhr.responseJSON);
  }
});
</script>


